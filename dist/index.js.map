{"version":3,"sources":["../webpack:/install-xenforo/src/config.ts","../webpack:/install-xenforo/src/index.ts","../webpack:/install-xenforo/src/install.ts","../webpack:/install-xenforo/src/installCommand.ts","../webpack:/install-xenforo/webpack/bootstrap","../webpack:/install-xenforo/webpack/startup"],"names":["__createBinding","this","Object","create","o","m","k","k2","undefined","desc","getOwnPropertyDescriptor","__esModule","writable","configurable","enumerable","get","defineProperty","__setModuleDefault","v","value","__importStar","mod","result","prototype","hasOwnProperty","call","exports","Config","core","__webpack_require__","constructor","db","debugMode","devMode","toString","host","port","username","password","dbname","static","getInput","parseInt","getBooleanInput","__importDefault","default","install_1","core_1","async","run","installXenForo","then","_","info","exec_1","axios_1","decompress_1","config_1","fs","io","installCommand_1","glob","fs_jetpack_1","path","globber","matchDirectories","installDir","Error","process","chdir","downloadAndExtractDistro","generateAndWriteConfig","runInstall","distUrl","resp","responseType","data","src","cwd","join","dst","files","findAsync","filePath","moveAsync","rmRF","writeFile","fromInput","exec","InstallCommand","toArray","adminUser","boardTitle","boardUrl","email","__webpack_module_cache__","moduleId","cachedModule","module","threw","__webpack_modules__","__webpack_exports__"],"mappings":"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","file":"index.js","sourcesContent":["\"use strict\";\r\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    var desc = Object.getOwnPropertyDescriptor(m, k);\r\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\r\n      desc = { enumerable: true, get: function() { return m[k]; } };\r\n    }\r\n    Object.defineProperty(o, k2, desc);\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}));\r\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n});\r\nvar __importStar = (this && this.__importStar) || function (mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.Config = void 0;\r\nconst core = __importStar(require(\"@actions/core\"));\r\nclass Config {\r\n    constructor(db, debugMode, devMode) {\r\n        this.db = db;\r\n        this.debugMode = debugMode;\r\n        this.devMode = devMode;\r\n    }\r\n    toString() {\r\n        return `<?php\n        $config['db']['host'] = '${this.db.host}';\n        $config['db']['port'] = ${this.db.port};\n        $config['db']['username'] = '${this.db.username}';\n        $config['db']['password'] = '${this.db.password}';\n        $config['db']['dbname'] = '${this.db.dbname}';\n        \n        $config['debug'] = ${this.debugMode};\n        $config['development']['enabled'] = ${this.devMode};\n        `;\r\n    }\r\n    static fromInput() {\r\n        return new Config({\r\n            host: core.getInput('dbHost'),\r\n            port: parseInt(core.getInput('dbPort')),\r\n            username: core.getInput('dbUsername'),\r\n            password: core.getInput('dbPassword'),\r\n            dbname: core.getInput('dbName'),\r\n        }, core.getBooleanInput('debugMode'), core.getBooleanInput('devMode'));\r\n    }\r\n}\r\nexports.Config = Config;\r\n","\"use strict\";\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst install_1 = require(\"./install\");\r\nconst core_1 = __importDefault(require(\"@actions/core\"));\r\nasync function run() {\r\n    await (0, install_1.installXenForo)();\r\n}\r\nrun().then(_ => {\r\n    core_1.default.info(\"XenForo installed!\");\r\n});\r\n","\"use strict\";\r\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    var desc = Object.getOwnPropertyDescriptor(m, k);\r\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\r\n      desc = { enumerable: true, get: function() { return m[k]; } };\r\n    }\r\n    Object.defineProperty(o, k2, desc);\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}));\r\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n});\r\nvar __importStar = (this && this.__importStar) || function (mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n};\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.installXenForo = void 0;\r\nconst core = __importStar(require(\"@actions/core\"));\r\nconst exec_1 = require(\"@actions/exec\");\r\nconst axios_1 = __importDefault(require(\"axios\"));\r\nconst decompress_1 = __importDefault(require(\"decompress\"));\r\nconst config_1 = require(\"./config\");\r\nconst fs = __importStar(require(\"fs/promises\"));\r\nconst io = __importStar(require(\"@actions/io\"));\r\nconst installCommand_1 = require(\"./installCommand\");\r\nconst glob = __importStar(require(\"@actions/glob\"));\r\nconst fs_jetpack_1 = __importDefault(require(\"fs-jetpack\"));\r\nconst path = __importStar(require(\"path\"));\r\nasync function installXenForo() {\r\n    const globber = await glob.create(core.getInput('path'), {\r\n        matchDirectories: true\r\n    });\r\n    const installDir = (await globber.glob())[0];\r\n    if (!installDir) {\r\n        throw new Error(\"Invalid installation path\");\r\n    }\r\n    process.chdir(installDir);\r\n    await downloadAndExtractDistro();\r\n    await generateAndWriteConfig();\r\n    await runInstall();\r\n}\r\nexports.installXenForo = installXenForo;\r\nasync function downloadAndExtractDistro() {\r\n    const distUrl = core.getInput('distUrl');\r\n    const resp = await axios_1.default.get(distUrl, {\r\n        responseType: \"arraybuffer\"\r\n    });\r\n    await (0, decompress_1.default)(resp.data, '.');\r\n    const src = fs_jetpack_1.default.cwd(path.join(process.cwd(), 'upload'));\r\n    const dst = fs_jetpack_1.default.cwd(process.cwd());\r\n    let files = await src.findAsync('.');\r\n    for (const filePath of files) {\r\n        await src.moveAsync(filePath, dst.path(filePath));\r\n    }\r\n    await io.rmRF('upload');\r\n}\r\nasync function generateAndWriteConfig() {\r\n    await fs.writeFile(path.join(process.cwd(), 'src', 'config.php'), config_1.Config.fromInput().toString());\r\n}\r\nasync function runInstall() {\r\n    await (0, exec_1.exec)('php', installCommand_1.InstallCommand.fromInput().toArray());\r\n}\r\n","\"use strict\";\r\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    var desc = Object.getOwnPropertyDescriptor(m, k);\r\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\r\n      desc = { enumerable: true, get: function() { return m[k]; } };\r\n    }\r\n    Object.defineProperty(o, k2, desc);\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}));\r\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n});\r\nvar __importStar = (this && this.__importStar) || function (mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.InstallCommand = void 0;\r\nconst core = __importStar(require(\"@actions/core\"));\r\nclass InstallCommand {\r\n    constructor(adminUser, boardTitle, boardUrl) {\r\n        this.adminUser = adminUser;\r\n        this.boardTitle = boardTitle;\r\n        this.boardUrl = boardUrl;\r\n    }\r\n    toArray() {\r\n        return [\r\n            'cmd.php',\r\n            'xf:install',\r\n            `--user=\"${this.adminUser.username}\"`,\r\n            `--password=\"${this.adminUser.password}\"`,\r\n            `--email=\"${this.adminUser.email}\"`,\r\n            `--title=\"${this.boardTitle}\"`,\r\n            `--url=\"${this.boardUrl}\"`,\r\n            '--skip-statistics'\r\n        ];\r\n    }\r\n    toString() {\r\n        return ['php cmd.php xf:install', ...this.toArray()].join(' ');\r\n    }\r\n    static fromInput() {\r\n        return new InstallCommand({\r\n            username: core.getInput('username'),\r\n            password: core.getInput('password'),\r\n            email: core.getInput('email'),\r\n        }, core.getInput('boardTitle'), core.getInput('boardUrl'));\r\n    }\r\n}\r\nexports.InstallCommand = InstallCommand;\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\tvar threw = true;\n\ttry {\n\t\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\t\tthrew = false;\n\t} finally {\n\t\tif(threw) delete __webpack_module_cache__[moduleId];\n\t}\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(6144);\n"]}